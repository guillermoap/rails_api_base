#!/usr/bin/env bash

if [[ -z $PARALLEL_TESTS_CONCURRENCY ]]; then
  OPENAPI=1 bundle exec rspec spec/requests/api/ --seed 1993
else
  OPENAPI=1 bundle exec parallel_rspec -n $PARALLEL_TESTS_CONCURRENCY spec/requests/api/ -o '--seed 1993'
fi

# sed command implementation is different for GNU and macOS
sed_i() {
  if [[ $OSTYPE == 'darwin'* ]]; then
	sed -i '' -E 's/[ '$'\t'']+$//' $@
  else
    sed -i 's/[ \t]*$//' $@
  fi
}

# Remove trailing whitespaces from doc file
sed_i doc/openapi.yaml
